(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{416:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("前言")]),s._v(" "),a("p",[s._v("本系列笔记又是 Liunx 学习系列教程的一大步, 本系列学习笔记记录 RedHat 系统的安全加固。本篇笔记记录 RedHat 下的防火请的开启和关闭, 还有允许哪些端口通过防火墙")])]),s._v(" "),a("h2",{attrs:{id:"防火墙的开启和关闭"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙的开启和关闭"}},[s._v("#")]),s._v(" 防火墙的开启和关闭")]),s._v(" "),a("h3",{attrs:{id:"永久性生效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#永久性生效"}},[s._v("#")]),s._v(" 永久性生效")]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("chkconfig")]),s._v(" , 重启后不会复原")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" iptables on         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" iptables off        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"即时生效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#即时生效"}},[s._v("#")]),s._v(" 即时生效")]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("service")]),s._v(" , 重启后复原")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables start        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables stop         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"iptables-命令解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iptables-命令解释"}},[s._v("#")]),s._v(" iptables 命令解释")]),s._v(" "),a("h3",{attrs:{id:"选项解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项解释"}},[s._v("#")]),s._v(" 选项解释")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("-t<表>")]),s._v(": 指定要操纵的表；")]),s._v(" "),a("li",[a("strong",[s._v("-A")]),s._v(": 向规则链中添加条目；")]),s._v(" "),a("li",[a("strong",[s._v("-D")]),s._v(": 从规则链中删除条目；")]),s._v(" "),a("li",[a("strong",[s._v("-I")]),s._v(": 向规则链中插入条目；")]),s._v(" "),a("li",[a("strong",[s._v("-R")]),s._v(": 替换规则链中的条目；")]),s._v(" "),a("li",[a("strong",[s._v("-L")]),s._v(": 显示规则链中已有的条目；")]),s._v(" "),a("li",[a("strong",[s._v("-F")]),s._v(": 清楚规则链中已有的条目；")]),s._v(" "),a("li",[a("strong",[s._v("-Z")]),s._v(": 清空规则链中的数据包计算器和字节计数器；")]),s._v(" "),a("li",[a("strong",[s._v("-N")]),s._v(": 创建新的用户自定义规则链；")]),s._v(" "),a("li",[a("strong",[s._v("-P")]),s._v(": 定义规则链中的默认目标；")]),s._v(" "),a("li",[a("strong",[s._v("-h")]),s._v(": 显示帮助信息；")]),s._v(" "),a("li",[a("strong",[s._v("-p")]),s._v(": 指定要匹配的数据包协议类型；")]),s._v(" "),a("li",[a("strong",[s._v("-s")]),s._v(": 指定要匹配的数据包源 ip 地址；")]),s._v(" "),a("li",[a("strong",[s._v("-j<目标>")]),s._v(": 指定要跳转的目标；")]),s._v(" "),a("li",[a("strong",[s._v("-i<网络接口>")]),s._v(": 指定数据包进入本机的网络接口；")]),s._v(" "),a("li",[a("strong",[s._v("-o<网络接口>")]),s._v(": 指定数据包要离开本机所使用的网络接口。")])]),s._v(" "),a("h3",{attrs:{id:"命令输入顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令输入顺序"}},[s._v("#")]),s._v(" 命令输入顺序")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("iptables -t 表名 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-A/I/D/R"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 规则链名 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("规则号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-i/o 网卡名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -p 协议名 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-s 源IP/源子网"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --sport 源端口 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("-d 目标IP/目标子网"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --dport 目标端口 -j 动作\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("表名包括")])])]),s._v(" "),a("p",[s._v("-- "),a("strong",[s._v("raw")]),s._v(": 高级功能, 如: 网址过滤。\n-- "),a("strong",[s._v("mangle")]),s._v(": 数据包修改（QOS）, 用于实现服务质量。\n-- "),a("strong",[s._v("net")]),s._v(": 地址转换, 用于网关路由器。\n-- "),a("strong",[s._v("filter")]),s._v(": 包过滤, 用于防火墙规则。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("规则链名包括")])])]),s._v(" "),a("p",[s._v("-- "),a("strong",[s._v("INPUT 链")]),s._v(": 处理输入数据包。\n-- "),a("strong",[s._v("OUTPUT 链")]),s._v(": 处理输出数据包。\n-- "),a("strong",[s._v("PORWARD 链")]),s._v(": 处理转发数据包。\n-- "),a("strong",[s._v("PREROUTING 链")]),s._v(": 用于目标地址转换（DNAT）。\n-- "),a("strong",[s._v("POSTOUTING 链")]),s._v(": 用于源地址转换（SNAT）。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("动作包括")])])]),s._v(" "),a("p",[s._v("-- "),a("strong",[s._v("ACCEPT")]),s._v(": 接收数据包。\n-- "),a("strong",[s._v("DROP")]),s._v(": 丢弃数据包。\n-- "),a("strong",[s._v("REDIRECT")]),s._v(": 重定向、映射、透明代理。\n-- "),a("strong",[s._v("SNAT")]),s._v(": 源地址转换。\n-- "),a("strong",[s._v("DNAT")]),s._v(": 目标地址转换。\n-- "),a("strong",[s._v("MASQUERADE")]),s._v(": IP 伪装（NAT）, 用于 ADSL。\n-- "),a("strong",[s._v("LOG")]),s._v(": 日志记录。")]),s._v(" "),a("h2",{attrs:{id:"iptables-的设置与查看"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iptables-的设置与查看"}},[s._v("#")]),s._v(" iptables 的设置与查看")]),s._v(" "),a("h3",{attrs:{id:"查看-iptables-的设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看-iptables-的设置"}},[s._v("#")]),s._v(" 查看 iptables 的设置")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("iptables -nL\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables status\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/iptables-1.png",alt:"iptables 的设置与查看"}})]),s._v(" "),a("h3",{attrs:{id:"清除已有-iptables-规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#清除已有-iptables-规则"}},[s._v("#")]),s._v(" 清除已有 iptables 规则")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("iptables -F\niptables -X\niptables -Z\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/iptables-2.png",alt:"iptables 的设置与查看"}})]),s._v(" "),a("h3",{attrs:{id:"开放指定的端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开放指定的端口"}},[s._v("#")]),s._v(" 开放指定的端口")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("iptables -A INPUT -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 -d "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 -j ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许本地回环接口(即运行本机访问本机)")]),s._v("\n\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许已建立的或相关连的通行")]),s._v("\n\niptables -A OUTPUT -j ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许所有本机向外的访问")]),s._v("\n\niptables -A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" -j ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许访问 22 端口")]),s._v("\n\niptables -A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -j ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许访问 80 端口")]),s._v("\n\niptables -A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" -j ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许 FTP  服务的 21 端口")]),s._v("\n\niptables -A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" -j ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许 FTP 服务的 20 端口")]),s._v("\n\niptables -A INPUT -j reject\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁止其他未允许的规则访问")]),s._v("\n\niptables -A FORWARD -j REJECT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁止其他未允许的规则访问")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[a("code",[s._v("-A")]),s._v(" 是在 "),a("code",[s._v("iptables")]),s._v(" 的最后添加一条规则, "),a("code",[s._v("-I")]),s._v(" 是在 "),a("code",[s._v("iptables")]),s._v(" 的前面添加一条规则")])]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/iptables-3.png",alt:"iptables 的设置与查看"}})]),s._v(" "),a("h3",{attrs:{id:"屏蔽-ip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#屏蔽-ip"}},[s._v("#")]),s._v(" 屏蔽 IP")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("iptables -I INPUT -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123.45")]),s._v(".6.7 -j DROP\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 屏蔽单个 IP 的命令")]),s._v("\n\niptables -I INPUT -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123.0")]),s._v(".0.0/8 -j DROP\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 封整个段即从 123.0.0.1 到 123.255.255.254 的命令")]),s._v("\n\niptables -I INPUT -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124.45")]),s._v(".0.0/16 -j DROP\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 封 IP 段即从 123.45.0.1 到 123.45.255.254 的命令")]),s._v("\n\niptables -I INPUT -s "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123.45")]),s._v(".6.0/24 -j DROP\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 封 IP 段即从 123.45.6.1 到 123.45.6.254 的命令")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"保存当前设置的规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#保存当前设置的规则"}},[s._v("#")]),s._v(" 保存当前设置的规则")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("/etc/rc.d/init.d/iptables save\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/iptables-4.png",alt:"iptables 的设置与查看"}})]),s._v(" "),a("br"),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/iptables-5.png",alt:"iptables 的设置与查看"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);